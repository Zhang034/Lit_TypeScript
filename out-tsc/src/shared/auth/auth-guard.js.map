{"version":3,"file":"auth-guard.js","sourceRoot":"","sources":["../../../../src/shared/auth/auth-guard.ts"],"names":[],"mappings":"AACA,OAAO,EAAE,oBAAoB,EAAE,MAAM,yBAAyB,CAAC;AAG/D,MAAM,OAAO,SAAS;IAGpB;QACE,IAAI,CAAC,WAAW,GAAG,IAAI,oBAAoB,EAAE,CAAC;IAChD,CAAC;IAEM,KAAK,CAAC,WAAW,CACtB,OAAgB,EAChB,QAAkB,EAClB,YAAqB;QAErB,MAAM,eAAe,GAAG,MAAM,IAAI,CAAC,WAAW,CAAC,YAAY,EAAE,CAAC;QAE9D,IAAI,CAAC,eAAe,EAAE;YACpB,OAAO,CAAC,IAAI,CAAC,qBAAqB,EAAE,OAAO,CAAC,QAAQ,CAAC,CAAC;YACtD,OAAO,QAAQ,CAAC,QAAQ,CAAC,YAAY,CAAC,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;SAC7D;QAED,OAAO,SAAS,CAAC;IACnB,CAAC;CACF;AAED,MAAM,CAAC,KAAK,UAAU,SAAS,CAAC,OAAgB,EAAE,QAAkB;IAClE,MAAM,eAAe,GAAG,MAAM,IAAI,oBAAoB,EAAE,CAAC,YAAY,EAAE,CAAC;IAExE,IAAI,CAAC,eAAe,EAAE;QACpB,OAAO,CAAC,IAAI,CAAC,qBAAqB,EAAE,OAAO,CAAC,QAAQ,CAAC,CAAC;QACtD,OAAO,QAAQ,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC;KAC/B;IAED,OAAO,SAAS,CAAC;AACnB,CAAC","sourcesContent":["import { Commands, Context, RedirectResult } from '@vaadin/router';\r\nimport { AuthorizationService } from './authorization-service';\r\nimport { PageEnabled } from './page-enabled';\r\n\r\nexport class AuthGuard implements PageEnabled {\r\n  private authService: AuthorizationService;\r\n\r\n  constructor() {\r\n    this.authService = new AuthorizationService();\r\n  }\r\n\r\n  public async pageEnabled(\r\n    context: Context,\r\n    commands: Commands,\r\n    pathRedirect?: string\r\n  ): Promise<RedirectResult | undefined> {\r\n    const isAuthenticated = await this.authService.isAuthorized();\r\n\r\n    if (!isAuthenticated) {\r\n      console.warn('User not authorized', context.pathname);\r\n      return commands.redirect(pathRedirect ? pathRedirect : '/');\r\n    }\r\n\r\n    return undefined;\r\n  }\r\n}\r\n\r\nexport async function authGuard(context: Context, commands: Commands) {\r\n  const isAuthenticated = await new AuthorizationService().isAuthorized();\r\n\r\n  if (!isAuthenticated) {\r\n    console.warn('User not authorized', context.pathname);\r\n    return commands.redirect('/');\r\n  }\r\n\r\n  return undefined;\r\n}\r\n"]}